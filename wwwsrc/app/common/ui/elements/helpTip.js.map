{"version":3,"sources":["common/ui/elements/helpTip.ts"],"names":[],"mappings":"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","file":"helpTip.js","sourcesContent":["import {bindable, customElement} from \"aurelia-framework\";\nimport {Threading} from \"../../core/threading\";\nimport {inject} from \"aurelia-dependency-injection\";\n\n@customElement(\"help-tip\")\n@inject(Element)\nexport class HelpTip {\n    @bindable\n    public content: string;\n    @bindable\n    public icon: string;\n    @bindable\n    public iconClass: string;\n    public showStyle: string;\n\n    public mainControl: HTMLElement;\n    public popup: HTMLElement;\n\n    private _scrollableParent: HTMLElement;\n    private _eventTarget: EventTarget;\n\n    private _repositionCallback: () => void;\n    private _hidePopupCallback: (event: Event) => void;\n    private _keyPress: (event: KeyboardEvent) => void;\n    private _element: HTMLElement;\n\n    constructor(element: HTMLElement) {\n        this._element = element;\n        this.content = \"\";\n        this.showStyle = \"\";\n        this.icon = \"?\";\n        this._repositionCallback = () => this.reposition();\n        this._hidePopupCallback = (event) => this.hidePopup(event);\n        this._keyPress = (event: KeyboardEvent) => {\n             this.hidePopup(event);\n        };\n    }\n\n    public attached(): void {\n        this._scrollableParent = this.findScrollableParent(this.mainControl);\n\n        if (this._scrollableParent === null) {\n            this._scrollableParent = window.document.body;\n            this._eventTarget = window;\n        } else {\n            this._eventTarget = this._scrollableParent;\n        }\n\n        this._eventTarget.addEventListener(\"resize\", this._repositionCallback);\n        this._eventTarget.addEventListener(\"scroll\", this._hidePopupCallback);\n        this._element.addEventListener(\"keydown\", this._keyPress);\n    }\n\n    public detached(): void {\n        this.hidePopup(null);\n        if (this._eventTarget) {\n            this._eventTarget.removeEventListener(\"resize\", this._repositionCallback);\n            this._eventTarget.removeEventListener(\"scroll\", this._hidePopupCallback);\n            this._element.removeEventListener(\"keydown\", this._keyPress);\n        }\n    }\n\n    public showPopup(event: MouseEvent): void {\n        if (this.showStyle === \"\") {\n            this.showStyle = \"visible\";\n            this.reposition();\n            if (event) {\n                event.stopPropagation();\n            }\n        }\n    }\n\n    public hidePopup(event: Event): void {\n        if (this.showStyle === \"visible\") {\n            this.showStyle = \"\";\n            if (this.popup) {\n                this.popup.style.left = \"\";\n                this.popup.style.top = \"\";\n            }\n            if (event) {\n                event.stopPropagation();\n            }\n        }\n    }\n\n    private reposition(): void {\n        if (this.mainControl && this.popup && this._scrollableParent) {\n            this.popup.style.transformOrigin = \"100% 0%\";\n\n            /* keep updating the position as the scale transforms finish */\n            let counter = 0;\n            let doTransformLeft = false;\n            let doTransformTop = false;\n            let originSet = false;\n            let timerId = Threading.startTimer(() => {\n                if (!this._scrollableParent || !this.popup || !this.mainControl) {\n                    Threading.stopTimer(timerId);\n                } else {\n                    let scrollRect = this._scrollableParent.getBoundingClientRect();\n\n                    let popupRect = this.popup.getBoundingClientRect();\n                    let mainRect = this.mainControl.getBoundingClientRect();\n\n                    if (popupRect.bottom > scrollRect.bottom ||\n                        popupRect.left < scrollRect.right ||\n                        doTransformLeft || doTransformTop) {\n                        let transformLeft = \"100%\";\n                        let transformTop = \"0%\";\n\n                        if (popupRect.bottom > scrollRect.bottom || doTransformTop) {\n                            doTransformTop = true;\n                            this.popup.style.top = \"-\" + (popupRect.height + mainRect.height + 5) + \"px\";\n                            transformTop = \"100%\";\n                        }\n\n                        if (popupRect.left < scrollRect.left || doTransformLeft) {\n                            doTransformLeft = true;\n                            this.popup.style.left = \"0px\";\n                            transformLeft = \"0%\";\n                        }\n\n                        if (!originSet) {\n                            originSet = true;\n                            this.popup.style.transformOrigin = transformLeft + \" \" + transformTop;\n                        }\n                    }\n\n                    counter++;\n                    if (counter === 30) {\n                        Threading.stopTimer(timerId);\n                    }\n                }\n            }, 10);\n        }\n    }\n\n    private findScrollableParent(node: HTMLElement): HTMLElement {\n        if (node === null) {\n            return null;\n        }\n\n        if (node.classList && node.classList.contains(\"help-tip-container\")) {\n            return node;\n        } else {\n            return this.findScrollableParent(node.parentElement);\n        }\n    }\n}\n"],"sourceRoot":"../../.."}