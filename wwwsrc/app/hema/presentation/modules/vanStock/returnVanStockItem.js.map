{"version":3,"sources":["hema/presentation/modules/vanStock/returnVanStockItem.ts"],"names":[],"mappings":"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","file":"returnVanStockItem.js","sourcesContent":["\nimport { inject } from \"aurelia-framework\";\nimport { DialogController, DialogService } from \"aurelia-dialog\";\nimport { ReturnVanStockItemViewModel } from \"./viewModels/returnVanStockItemViewModel\";\nimport { ConfirmDialogModel } from \"../../../../common/ui/dialogs/models/confirmDialogModel\";\nimport { ConfirmDialog } from \"../../../../common/ui/dialogs/confirmDialog\";\nimport { CatalogService } from \"../../../business/services/catalogService\";\nimport { ICatalogService } from \"../../../business/services/interfaces/ICatalogService\";\nimport { IPartsNotUsedReason } from \"../../../business/models/reference/IPartsNotUsedReason\";\nimport { PartsHelper } from \"../../../core/partsHelper\";\n\n@inject(DialogController, DialogService, CatalogService)\nexport class ReturnVanStockItem {\n    public viewModel: ReturnVanStockItemViewModel;\n    public availableReturnQuantity: number;\n    public minReturnQuantity: number;\n    public controller: DialogController;\n    public materialReturnReasonsCatalog: IPartsNotUsedReason[];\n\n    private _dialogService: DialogService;\n    private _catalogService: ICatalogService;\n\n    constructor(dialogController: DialogController,\n        dialogService: DialogService,\n        catalogService: ICatalogService) {\n        this.minReturnQuantity = 1;\n        this.controller = dialogController;\n        this._dialogService = dialogService;\n        this._catalogService = catalogService;\n        if (this.controller) {\n            this.controller.settings.lock = true;\n            this.viewModel = this.controller.settings.model;\n        }\n    }\n\n    public async attached(): Promise<void> {\n        const allReasons = await this._catalogService.getPartsNotUsedReasons();\n        this.materialReturnReasonsCatalog = PartsHelper.filterPartsNotUsedReasonsForAssetTracking(allReasons);\n        this.populateModel();\n    }\n\n    public submit(): Promise<void> {\n        let vm: ConfirmDialogModel = new ConfirmDialogModel();\n        vm.header = \"Confirmation\";\n        vm.text = `Are you sure that your wish to return ${this.viewModel.material.stockReferenceId}?`;\n        this._dialogService.open({ viewModel: ConfirmDialog, model: vm }).then((result) => {\n            if (result.wasCancelled === false) {\n                this.controller.ok(this.viewModel);\n            }\n        });\n        return Promise.resolve();\n    }\n\n    private populateModel(): void {\n        if (!this.viewModel.quantityToReturn) {\n            this.viewModel.quantityToReturn = this.minReturnQuantity;\n        }\n        if (this.viewModel.material) {\n            if (this.viewModel.material.quantity - this.viewModel.material.quantityToBeReturned > 0) {\n                this.availableReturnQuantity = this.viewModel.material.quantity - this.viewModel.material.quantityToBeReturned;\n            } else {\n                this.availableReturnQuantity = this.viewModel.material.quantity;\n            }\n        } else {\n            this.availableReturnQuantity = 0;\n        }\n        if (!this.viewModel.returnReason) {\n            this.viewModel.returnReason = this.materialReturnReasonsCatalog[0].partsNotUsedReasonDescription;\n        }\n    }\n}\n"],"sourceRoot":"../../../.."}