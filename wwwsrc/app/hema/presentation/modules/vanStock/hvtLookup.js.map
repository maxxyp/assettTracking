{"version":3,"sources":["hema/presentation/modules/vanStock/hvtLookup.ts"],"names":[],"mappings":"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","file":"hvtLookup.js","sourcesContent":["\nimport { inject, observable } from \"aurelia-framework\";\nimport { DialogController } from \"aurelia-dialog\";\nimport { VanStockService } from \"../../../business/services/vanStockService\";\nimport { IVanStockService } from \"../../../business/services/interfaces/IVanStockService\";\nimport { MaterialHighValueTool } from \"../../../business/models/materialHighValueTool\";\nimport { VanStockServiceConstants } from \"../../../business/services/constants/vanStockServiceConstants\";\n\n@inject(DialogController, VanStockService)\nexport class HvtLookup {\n    public material: MaterialHighValueTool[];\n    public controller: DialogController;\n    @observable\n    public searchText: string;    \n    public hideLoadMore: boolean;\n\n    private _vanStockService: IVanStockService;\n    private _currentCount: number;\n    private readonly _pageSize: number;\n\n    constructor(dialogController: DialogController,\n        vanStockService: IVanStockService) {\n        this.controller = dialogController;\n        this._vanStockService = vanStockService;\n        this._pageSize = 1000;        \n        this._currentCount = this._pageSize;\n        this.hideLoadMore = false;        \n        if (this.controller) {\n            this.controller.settings.lock = true;\n            this.material = this.controller.settings.model;\n        }\n    }\n\n    public async attached(): Promise<void> {\n        const material = await this._vanStockService.getHighValueToolList(this._currentCount, this.searchText);\n        if (material) {\n            this.material = material;\n            this.showHideLoadMore(this.searchText);\n        }\n    }\n\n    public async loadMore(): Promise<void> {\n        this._currentCount = this._currentCount + this._pageSize;\n        this.material = await this._vanStockService.getHighValueToolList(this._currentCount, this.searchText);\n        this.showHideLoadMore(this.searchText);\n        return;\n    }\n\n    public async searchTextChanged(newValue: string, oldValue: string): Promise<void> {\n        if (!newValue) {\n            newValue = \"\";\n        }\n        if (!oldValue) {\n            oldValue = \"\";\n        }\n        newValue = newValue.trim();        \n        oldValue = oldValue.trim();\n        if (this.searchAutoCorrect(newValue, oldValue)) {\n            this.material = await this._vanStockService.getHighValueToolList(this._currentCount, newValue);\n            this.showHideLoadMore(newValue);\n        }\n        return;\n    }    \n\n    private searchAutoCorrect(newValue: string, oldValue: string): boolean {\n        if (newValue && (newValue.length === 1 && newValue === \"@\")) {\n            this.searchText = VanStockServiceConstants.AREA_SEARCH_PREFIX;\n            return false;\n        }\n        return true;\n    }\n    \n    private async showHideLoadMore(searchText: string): Promise<void> {\n        const totalVanStockCount = await this._vanStockService.getHighValueToolTotal(searchText);\n        this.hideLoadMore = totalVanStockCount === this.material.length;        \n    }\n}\n"],"sourceRoot":"../../../.."}