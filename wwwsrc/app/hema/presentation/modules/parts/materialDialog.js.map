{"version":3,"sources":["hema/presentation/modules/parts/materialDialog.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAiBA;QAAoC,kCAAa;QAI7C,wBAAY,YAA2B,EAAE,eAAgC,EAAE,aAA4B,EAAE,UAA4B;YAArI,YACI,kBAAM,YAAY,EAAE,eAAe,EAAE,aAAa,CAAC,SAEtD;YADG,KAAI,CAAC,UAAU,GAAG,UAAU,CAAC;;QACjC,CAAC;QAEY,sCAAa,GAA1B,UAA2B,MAGtB;;;;oBAEO,oBAAoB,GAAW,MAAM,qBAAjB,EAAE,IAAI,GAAK,MAAM,KAAX,CAAY;oBAE9C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;oBACjE,IAAI,CAAC,WAAW,EAAE,CAAC;;;;SAC1B;QAEgB,2BAAE,GAAf;;;;;;4BAEQ,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe;gCAChD,CAAC,CAAC,GAAG;gCACL,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,oBAAoB;oCACjC,CAAC,CAAC,GAAG;oCACL,CAAC,CAAC,GAAG,CAAC;4BAEd,qBAAM,IAAI,CAAC,UAAU,CAAC,EAAE,CAAwB;oCAC5C,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,oBAAoB,IAAI,IAAI,CAAC,SAAS,CAAC,eAAe;oCAC/E,eAAe,iBAAA;iCAClB,CAAC,EAAA;;4BAHF,SAGE,CAAC;;;;;SACN;QAEO,uCAAc,GAAtB,UACI,oBAA0C,EAC1C,IAAU;YAGV,MAAM,CAAC;gBACH,eAAe,EAAE,oBAAoB,CAAC,KAAK,CAAC,gBAAgB,KAAK,OAAO;oBACpD,CAAC,CAAC,oBAAoB,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ;oBAC9C,CAAC,CAAC,CAAC;gBACvB,eAAe,EAAE,IAAI,CAAC,eAAe,KAAK,GAAG;oBACzB,CAAC,CAAC,IAAI,CAAC,QAAQ;oBACf,CAAC,CAAC,CAAC;gBACvB,oBAAoB,EAAE,IAAI,CAAC,eAAe,KAAK,GAAG;oBAC9B,CAAC,CAAC,IAAI,CAAC,QAAQ;oBACf,CAAC,CAAC,CAAC;aAC1B,CAAC;QACN,CAAC;QAlDQ,cAAc;YAD1B,qCAAM,CAAC,2BAAY,EAAE,0CAAe,EAAE,8BAAa,EAAE,iCAAgB,CAAC;qDAKT,0CAAe,EAAiB,8BAAa,EAAc,iCAAgB;WAJ5H,cAAc,CAmD1B;QAAD,qBAAC;KAnDD,AAmDC,CAnDmC,6BAAa,GAmDhD;IAnDY,wCAAc","file":"materialDialog.js","sourcesContent":["import { BaseViewModel } from \"../../models/baseViewModel\";\r\nimport { DialogController, DialogService } from \"aurelia-dialog\";\r\nimport { EventAggregator } from \"aurelia-event-aggregator\";\r\nimport { ILabelService } from \"../../../business/services/interfaces/ILabelService\";\r\nimport { LabelService } from \"../../../business/services/labelService\";\r\nimport { inject } from \"aurelia-dependency-injection\";\r\nimport { Part } from \"../../../business/models/part\";\r\nimport { MaterialSearchResult } from \"../../../business/models/materialSearchResult\";\r\nimport { MaterialDialogResult } from \"./materialDialogResult\";\r\n\r\ntype ViewModel =  {\r\n    quantityOnMyVan: number;\r\n    quantityFromVanStock: number;\r\n    quantityToOrder: number;\r\n};\r\n\r\n@inject(LabelService, EventAggregator, DialogService, DialogController)\r\nexport class MaterialDialog extends BaseViewModel {\r\n    public controller: DialogController;\r\n    public viewModel: ViewModel;\r\n\r\n    constructor(labelService: ILabelService, eventAggregator: EventAggregator, dialogService: DialogService, controller: DialogController) {\r\n        super(labelService, eventAggregator, dialogService);\r\n        this.controller = controller;\r\n    }\r\n\r\n    public async activateAsync(params: {\r\n            materialSearchResult: MaterialSearchResult,\r\n            part: Part\r\n        }): Promise<void> {\r\n\r\n        const { materialSearchResult, part } = params;\r\n\r\n        this.viewModel = this.buildViewModel(materialSearchResult, part);\r\n        this.showContent();\r\n}\r\n\r\n    public async ok(): Promise<void> {\r\n\r\n        let partOrderStatus = this.viewModel.quantityToOrder\r\n            ? \"O\"\r\n            : this.viewModel.quantityFromVanStock\r\n                ? \"V\"\r\n                : \"O\";\r\n\r\n        await this.controller.ok(<MaterialDialogResult> {\r\n            quantity: this.viewModel.quantityFromVanStock || this.viewModel.quantityToOrder,\r\n            partOrderStatus\r\n        });\r\n    }\r\n\r\n    private buildViewModel(\r\n        materialSearchResult: MaterialSearchResult,\r\n        part: Part)\r\n    : ViewModel {\r\n\r\n        return {\r\n            quantityOnMyVan: materialSearchResult.local.completionStatus === \"FOUND\"\r\n                                ? materialSearchResult.local.material.quantity\r\n                                : 0,\r\n            quantityToOrder: part.partOrderStatus === \"O\"\r\n                                ? part.quantity\r\n                                : 0,\r\n            quantityFromVanStock: part.partOrderStatus !== \"O\"\r\n                                ? part.quantity\r\n                                : 0\r\n        };\r\n    }\r\n}\r\n"],"sourceRoot":"../../../.."}